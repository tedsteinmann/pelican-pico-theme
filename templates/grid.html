{% extends "base.html" %}
{% import "macros/grid.j2" as grids %}

{% block content %}
<section class="grid-page">
    <header class="grid-page__header">
        <h2>{{ page.title }}</h2>
        {% if page.summary %}
        <p>{{ page.summary }}</p>
        {% endif %}
    </header>

    {% set grid_category = page.metadata.grid_category or page.metadata.category or 'service' %}
    {% set grid_columns = page.metadata.columns or 3 %}
    {% set candidates = [] %}

    {% if pages is defined %}
        {% set candidates = candidates + (pages | rejectattr('source_path', 'equalto', page.source_path) | selectattr('metadata.category', 'equalto', grid_category) | list) %}
    {% endif %}
    {% if articles is defined %}
        {% set candidates = candidates + (articles | selectattr('metadata.category', 'equalto', grid_category) | list) %}
    {% endif %}

    {% if candidates %}
        {{ grids.grid(candidates, grid_columns) }}
    {% else %}
        <p role="status">No entries were found for the <strong>{{ grid_category }}</strong> category.</p>
    {% endif %}
</section>
{% endblock %}
