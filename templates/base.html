<!DOCTYPE html>
<html lang="{{ DEFAULT_LANG }}">
<head>
    {% block head %}
    <title>{% if article %}{{ article.title }} | {% elif page %}{{ page.title }} | {% endif %} {{ AUTHOR }}</title>
    <meta charset="utf-8" />
    <meta name="generator" content="Pelican" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="{{ AUTHOR }}" />
    {% if article and article.summary %}
    {% set _raw_meta = article.summary %}
    {% elif page and page.summary %}
    {% set _raw_meta = page.summary %}
    {% else %}
    {% set _raw_meta = DESCRIPTION %}
    {% endif %}
    {% set meta_description = _raw_meta|striptags|truncate(160) %}
    {% set meta_description_long = _raw_meta|striptags|truncate(200) %}

    <meta name="description" content="{{ meta_description }}" />
    {% if article and article.keywords %}
    <meta name="keywords" content="{{ article.keywords }}" />
    {% endif %}
    {% if article and article.summary %}
    <meta name="summary" content="{{ meta_description_long }}" />
    {% endif %}

    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:type" content="{% if article %}article{% else %}website{% endif %}" />
    <meta property="og:title" content="{% if article %}{{ article.title }}{% elif page %}{{ page.title }}{% else %}{{ SITENAME }}{% endif %}" />
    <meta property="og:description" content="{{ meta_description_long }}" />
    <meta property="og:url" content="{{ SITEURL }}/{% if article %}{{ article.url }}{% elif page %}{{ page.url }}{% endif %}" />
    
    <!-- Social Share Plugin Images (priority) -->
    {% if article and article.metadata.social_image %}
    <meta property="og:image" content="{{ SITEURL }}{{ article.metadata.social_image }}" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="675" />
    {% elif page and page.metadata.social_image %}
    <meta property="og:image" content="{{ SITEURL }}{{ page.metadata.social_image }}" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="675" />
    <!-- Fallback to existing SEO setup -->
    {% elif article and article.og_image %}
    <meta property="og:image" content="{{ SITEURL }}/static/{{ article.og_image }}" />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    {% elif SEO.og_image %}
    <meta property="og:image" content="{{ SITEURL }}/static/{{ SEO.og_image }}" />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    {% endif %}

    <!-- Twitter Card Meta Tags -->
    {% if SEO.twitter_username %}
    <meta name="twitter:creator" content="@{{ SEO.twitter_username }}" />
    {% endif %}
    <meta name="twitter:title" content="{% if article %}{{ article.title }}{% elif page %}{{ page.title }}{% else %}{{ SITENAME }}{% endif %}" />
    <meta name="twitter:description" content="{{ meta_description_long }}" />
    
    <!-- Twitter Card Image (follows same priority as OG) -->
    {% if article and article.metadata.social_image %}
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="{{ SITEURL }}{{ article.metadata.social_image }}" />
    {% elif page and page.metadata.social_image %}
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="{{ SITEURL }}{{ page.metadata.social_image }}" />
    {% elif article and article.og_image %}
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="{{ SITEURL }}/static/{{ article.og_image }}" />
    {% elif SEO.og_image %}
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="{{ SITEURL }}/static/{{ SEO.og_image }}" />
    {% else %}
    <meta name="twitter:card" content="summary" />
    {% endif %}
    
    <link rel="stylesheet" href="/theme/css/pico.min.css">
    <link rel="icon" type="image/png" href="/theme/images/favicon.ico">

    <link rel="stylesheet" href="/theme/css/style.css">
    {% endblock head %}
</head>
<body{% block body_class %}{% endblock %}>
    {% block navbar %}{% include 'navbar.html' %}{% endblock %}
    <!-- Content -->
    <main>
        <section id="index">
            <div class="container">
                {% block content %}{% endblock %}
            </div>
        </section>
    </main>
</body>
</html>
