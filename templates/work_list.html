{% extends "base.html" %}

{% block content %}
{% set section_config = CATEGORY_DISPLAY_CONFIG | default({}) %}
{% set work_config = section_config.get('work', {}) %}
{% set display_name = work_config.get('display', 'My Work') %}
{% set jsonld_type = work_config.get('jsonld_type', 'CreativeWork') %}

<h2>{{ display_name }}</h2>

<!-- JSON-LD Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "{{ display_name }}",
  "description": "{{ display_name }} by {{ AUTHOR }}",
  "author": {
    "@type": "Person",
    "name": "{{ AUTHOR }}"
  },
  "url": "{{ SITEURL }}/{{ work_config.get('url', 'work') }}/"
}
</script>

{% set grouped_articles = {} %}

<!-- Group articles by category -->
{% for article in articles %}
    {% if article.relative_source_path.startswith("work/") %}
        {% set category = article.category %}
        {% if category not in grouped_articles %}
            {% set _ = grouped_articles.update({category: []}) %}
        {% endif %}
        {% set _ = grouped_articles[category].append(article) %}
    {% endif %}
{% endfor %}

<!-- Loop through grouped articles -->
{% for category, category_articles in grouped_articles.items() %}
    <h3>{{ category|capitalize }}</h3>
    <ul style="list-style: none; padding: 0;">
        {% for article in category_articles %}
            {% include "article_item.html" %}
        {% endfor %}
    </ul>
{% endfor %}

{% include 'footer.html' %}

{% endblock %}
